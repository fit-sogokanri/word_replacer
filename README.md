# Word Replacer

wordファイル内に含まれるワイルドカードを置換する

## 機能
#### Wordファイル内にあるワイルドカードを指定のワードに置換する
ベースとなるWordファイルから、csvに書かれたワイルドカードで置換したファイルを、csvファイルの行の数、作成します。
#### Wordファイルをpdf化する
ディレクトリにあるWordファイルを全てpdf化します。

## ダウンロード
#### git環境がある場合
下記コマンドを実行してください。  
`git clone https://github.com/fit-sogokanri/word_replacer.git`

#### git環境がない場合
[こちら](https://github.com/fit-sogokanri/word_replacer/archive/refs/heads/master.zip)からダウンロードし展開してください。


## 使い方
### 準備物
- ワイルドカードを含んだwordファイル(.docxの拡張子のみ有効)【ベースWordファイル】  
ワイルドカードは次の置換設定csvで設定したものを使用してください。  
Wordファイルでワイルドカードを記述するとき、**ワイルドカードの装飾**(文字サイズ、フォント、色など)**は必ず統一**してください。また、Wordの挙動で、行先頭や装飾文字の直後に文字を書くと内部データで装飾データが分割されることがある(=ワイルドカードが分割される)ので、ワイルドカードの前に余計な文字を入れてワイルドカードを書き、余計なワードを消すという手法が確実です。  
例) ワイルドカードが{{wildcard1}}の時の記述の仕方  
    ～～～である。(ここにワイルドカードを入れる)だからこそ～～～である。  
    1.～～～である。__{__{{wildcard1}}だからこそ～～～である。  
    2.～～～である。{{wildcard1}}だからこそ～～～である。 


- ワイルドカードと置換するワードのペアが羅列されたcsvファイル【置換設定csv】  
ワイルドカードとその場所に置換するワードを記述します。  
ワイルドカードとワードは列で紐づきます。例えば、ワイルドカード1の部分はワード1-nで置換されます(nは行数)。  
なお、**ワイルドカード1の部分は生成されるWordファイルの名前に使用されます。**　(「共通名 ワイルドカード1.docx」みたいになります)  
ワイルドカードとワードは(リソースが許す限り)無限に設定できます。ワイルドカードは右方向に、ワードは下方向に拡張できます。  
ワイルドカードは自身で設定可能です。ベースWordファイルに含まれない記号と英数字で構成されているといいと思います。  
ワードは(多分)どんな文字列でも大丈夫です。  

|                 |                 |                 | 
| --------------- | --------------- | --------------- | 
| ワイルドカード1 | ワイルドカード2 | ワイルドカード3 | 
| ワード1-1       | ワード1-2       | ワード1-3       | 
| ワード2-1       | ワード2-2       | ワード2-3       | 

### 実行方法
#### Wordファイル置換
1. ベースWordファイルと置換設定csvをmain.pyと同じディレクトリに入れます。
2. main.pyのあるディレクトリ(フォルダ)内でPowerShellまたはコマンドラインを起動します。
3. `python main.py 置換設定csvのファイル名 ベースwordファイルのファイル名 生成するWordファイルに共通していれるファイル名`を2のpowershellで実行します。
4. 置換されたWordファイルが`ProcessedWordFile`ディレクトリに生成されます。
#### pdf化する
1. Wordファイルを`ProcessedWordFile`ディレクトリに入れます。
2. main.pyのあるディレクトリ(フォルダ)内でPowerShellまたはコマンドラインを起動します。
3. `python convert_pdf.py`を2のpowershellで実行します。
4. pdfが`pdf`ディレクトリに生成されます。

## 製作者
Sou Tamura([tmsou0209](https://github.com/tmsou0209))

## ライセンス
MITライセンス
